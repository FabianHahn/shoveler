package(default_visibility = ["//visibility:public"])

cc_library(
    name = "ecs",
    srcs = [
        "src/client_connection_manager.c",
        "src/client_network_adapter.c",
        "src/client_op.c",
        "src/client_op_emitter.c",
        "src/client_property_manager.c",
        "src/component.c",
        "src/component_field.c",
        "src/component_system.c",
        "src/component_type.c",
        "src/component_type_indexer.c",
        "src/entity_id_allocator.c",
        "src/in_memory_network_adapter.c",
        "src/schema.c",
        "src/server_controller.c",
        "src/server_network_adapter.c",
        "src/server_op.c",
        "src/server_op_handler.c",
        "src/system.c",
        "src/world.c",
        "src/world_dependency_graph.c",
    ],
    hdrs = [
        "include/shoveler/client_connection_manager.h",
        "include/shoveler/client_network_adapter.h",
        "include/shoveler/client_op.h",
        "include/shoveler/client_op_emitter.h",
        "include/shoveler/client_property_manager.h",
        "include/shoveler/component.h",
        "include/shoveler/component_field.h",
        "include/shoveler/component_system.h",
        "include/shoveler/component_type.h",
        "include/shoveler/component_type_indexer.h",
        "include/shoveler/entity_component_id.h",
        "include/shoveler/entity_id_allocator.h",
        "include/shoveler/in_memory_network_adapter.h",
        "include/shoveler/schema.h",
        "include/shoveler/server_controller.h",
        "include/shoveler/server_network_adapter.h",
        "include/shoveler/server_op.h",
        "include/shoveler/server_op_handler.h",
        "include/shoveler/system.h",
        "include/shoveler/world.h",
        "include/shoveler/world_dependency_graph.h",
    ],
    includes = ["include"],
    deps = [
        "//base",
    ],
)

cc_test(
    name = "ecs_tests",
    srcs = [
        "src/client_connection_manager_test.cpp",
        "src/client_network_adapter_event_wrapper.h",
        "src/client_op_emitter_test.cpp",
        "src/client_op_test.cpp",
        "src/client_op_wrapper.h",
        "src/client_property_manager_test.cpp",
        "src/component_field_test.cpp",
        "src/component_field_value_wrapper.h",
        "src/component_test.cpp",
        "src/component_type_indexer_test.cpp",
        "src/in_memory_network_adapter_test.cpp",
        "src/server_network_adapter_event_wrapper.h",
        "src/server_op_test.cpp",
        "src/server_op_wrapper.h",
        "src/test.cpp",
        "src/test_component_types.h",
        "src/world_test.cpp",
    ],
    linkstatic = True,
    deps = [
        ":ecs",
        "@googletest//:gtest",
    ],
)
